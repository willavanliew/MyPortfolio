---
title: "TidyTuesdayYarn"
format: html
editor: visual
categories: [analysis, tidytuesday, yarn]
image: "jean-marc-vieregge-cDKqFb-NOZc-unsplash.jpg"
---

This is where I will be putting a short description of analysis 


image from: Jean-Marc Vieregge via Unsplash

## Background 
Describe the tidy tuesday prompt and what the user did 
Analysis based on <a href="https://github.com/awalsh17/ravelry_yarns/blob/main/code/explore_yarn.R" target="_blank">awalsh17/ravelry_yarns</a>

Why am i interested in this?

Add a photo of my projects (in a slide show format)

### Code

```{r}
#| echo: false
#| include: false
#| message: false
#| warning: false
library(dplyr)
library(tidyverse)
library(ggplot2)
library(MetBrewer)
library(ggtext)
library(sysfonts)
library(showtext)
library(caret)
library(skimr)
```

```{r}
yarn <- read_csv('./data/yarn.csv')
head(yarn)
```

```{r}
df <- yarn %>%
  select(yarn_company_name, rating_average, rating_count,yarn_weight_name) %>%
  tidyr::drop_na()
df
```
```{r}
top3 = df %>%
  filter(rating_average == 5.00) %>%
  group_by(yarn_company_name) %>%
  summarize(totalnumber = n()) %>%
  arrange(desc(totalnumber)) %>%
  filter(totalnumber > 30) %>%
  head(3)
```

```{r}
df %>%
  filter(rating_average == 5.00) %>%
  group_by(yarn_company_name) %>%
  summarize(totalnumber = n()) %>%
  arrange(desc(totalnumber)) %>%
  filter(totalnumber > 30) %>%
  ggplot() +
  geom_col(aes(y = fct_reorder(yarn_company_name, totalnumber), x = totalnumber), fill = "grey") +
  geom_col(data = top3, aes(y = fct_reorder(yarn_company_name, totalnumber), x = totalnumber), fill = "darkred") +
  labs(
    title= "Which Yarn Company has the highest number of perfect ratings?",
    x = "Total Number of 5 star ratings",
    y = "Company Name"
  ) +
  theme_minimal()
```

