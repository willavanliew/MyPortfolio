---
title: "Avalanche Analysis"
editor: visual
html:
  code-fold: true
  code-summary: "Show the code"
image: "AvalancheImage.jpeg"
categories: [analysis, skiing, interests]
---


Some thing here to describe what the analysis is about 

## Avalanche Incidents and Fatality Analysis 

# Todo

1.  Change colors
2.  Themes
3.  Add background information
4.  State mountain information

# Background

Data from CAIC 2022 
1. Describe what is being shown 
2. Describe variables being used 
3. Describe interest in the analysis

```{r}
#| echo: false
#| include: false
#| message: false
#| warning: false
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(gganimate)
accidents = read_csv("./data/Accidents_2022_PUBLIC (1).csv")
accidents = rename(accidents, dSize = `D Size`)
accidents = accidents %>%
  mutate(TravelMode = ifelse(TravelMode %in% c("SKi", "Ski"), "Ski", TravelMode))
```

#Have Avalanche Incidents and Fatalities increased over the years?

```{r}
#| code-fold: true
#| code-summary: "Show the code"
accidents %>%
  group_by(YYYY) %>%
  summarize(totalIncidents = n(), totalDeaths = sum(Killed)) %>%
  ggplot() + 
  geom_line(aes(x = YYYY, y = totalIncidents), color = "red") +
  geom_line(aes(x = YYYY, y = totalDeaths)) +
  geom_text(aes(x = 2003, y = 17, label = "INCIDENTS", family = "Times New Roman"), color = "red") +
  geom_text(aes(x = 1987, y = 25, label = "DEATHS", family = "Times New Roman")) +
  labs(title = "HAVE AVALANCHE INCIDENTS AND DEATHS INCREASED OVER TIME?", 
       x = "YEAR",
       y = "TOTAL EVENTS")
```

# Does mode of transportation impact the number of accidents?

```{r}
#| code-fold: true
#| code-summary: "Show the code"
accidents %>%
  filter(TravelMode %in% c("Foot", "Ski", "Snowboard", "Snowshoe")) %>%
  group_by(TravelMode) %>%
  summarize(total_accidents = n(), total_deaths = sum(Killed)) %>%
  ggplot(aes(x = TravelMode, y = total_accidents)) +
  geom_col()
```

```{r}
#| code-fold: true
#| code-summary: "Show the code"
travel_type = accidents %>%
  filter(TravelMode %in% c("Foot", "Ski", "Snowboard", "Snowshoe")) %>%
  group_by(TravelMode) %>%
  summarize(total_accidents = n(), total_deaths = sum(Killed))

travel_type = gather(travel_type, "type", "count", -TravelMode)

```

```{r}
#| code-fold: true
#| code-summary: "Show the code"
travel_type %>%
  ggplot() +
  geom_col(aes(x = fct_reorder(TravelMode, desc(count)), y = count, fill = type), position = "dodge") +
  labs(title = "TBD", 
       x = "Travel Mode", 
       y = "Number of Incidents") +
  scale_fill_discrete(name = "Incident Type", labels = c("Avalanche", "Death"))
```

# Which States have highest consentration of Avalanche Accidents?

```{r}
#| code-fold: true
#| code-summary: "Show the code"
accidents %>%
  group_by(State) %>%
  summarize(total_accidents = n()) %>%
  filter(total_accidents > 1) %>%
  ggplot() +
  geom_col(aes(y = total_accidents, x = fct_reorder(State, desc(total_accidents)))) +
  labs(title = "Which State has the Highest Number of Avalanches?",
       x = "State",
       y = "Total Accidents") +
  theme_minimal()

```

```{r}
#| code-fold: true
#| code-summary: "Show the code"
accidents_state = accidents %>%
  group_by(State) %>%
  summarize(total_accidents = n(), total_deaths = sum(Killed)) %>%
  filter(total_accidents > 1) 

accidents_state = gather(accidents_state, "type", "count", -State)

```

```{r}
#| code-fold: true
#| code-summary: "Show the code"
accidents_state %>%
  ggplot() +
  geom_col(aes(x = fct_reorder(State, desc(count)), y = count, fill = type), position = "dodge") +
  labs(title = "TBD", 
       x = "State", 
       y = "Number of Incidents") +
  scale_fill_discrete(name = "Incident Type", labels = c("Avalanche", "Death"))

```
